---
milestone: v1.1
audited: 2026-02-28T00:00:00Z
status: gaps_found
scores:
  requirements: 9/13
  phases: 2/3
  integration: 7/7
  flows: 4/4
gaps:
  requirements:
    - id: "SEO-01"
      status: "orphaned"
      phase: "Phase 6"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "orphaned"
      evidence: "Phase 6 (SEO & Sitemap) has no directory, no plans, and no VERIFICATION.md. Requirement is assigned in REQUIREMENTS.md traceability table but absent from all phase verifications."
    - id: "SEO-02"
      status: "orphaned"
      phase: "Phase 6"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "orphaned"
      evidence: "Same as SEO-01 — Phase 6 not started."
    - id: "SEO-03"
      status: "orphaned"
      phase: "Phase 6"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "orphaned"
      evidence: "Same as SEO-01 — Phase 6 not started."
    - id: "SEO-04"
      status: "orphaned"
      phase: "Phase 6"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "orphaned"
      evidence: "/download is absent from src/app/sitemap.ts. Phase 6 not started."
  integration:
    - "LayoutContent gate: /download is not in allowedPaths array in LayoutContent.tsx. When NEXT_PUBLIC_IS_LAUNCHED is not 'true' (e.g. production without env var set), desktop users see <ComingSoon /> instead of the download page. Affects: PAGE-01, PAGE-02, PAGE-03, PAGE-04, RDIR-03, RDIR-04."
  flows: []
tech_debt:
  - phase: 05-fallback-page-component
    items:
      - "SUMMARY.md missing requirements-completed frontmatter (requirements_completed: [] instead of [PAGE-01, PAGE-02, PAGE-03, PAGE-04])"
      - "Smart App Banner (PAGE-03) requires human verification on real iOS Safari device"
  - phase: 04-device-detection-middleware
    items:
      - "iOS and Android redirects require human verification on real devices before launch"
      - "Social crawler pass-through (Slackbot) requires live deployment verification"
  - phase: deployment
    items:
      - "LayoutContent gate: /download should be added to allowedPaths OR NEXT_PUBLIC_IS_LAUNCHED must be 'true' in production for /download to be accessible"
---

# Milestone v1.1 "App Download Page" Audit Report

**Audited:** 2026-02-28
**Status:** gaps_found
**Score:** 9/13 requirements satisfied

## Phase Summary

| Phase | Status | Score | Verification |
|-------|--------|-------|-------------|
| 4. Device Detection & Middleware | Complete | 7/7 truths | passed |
| 5. Fallback Page & Component | Complete | 4/5 truths (1 human_needed) | passed |
| 6. SEO & Sitemap | Not started | 0/0 | missing |

## Requirements Coverage (3-Source Cross-Reference)

### Phase 4: Device Detection & Middleware

| REQ-ID | Description | VERIFICATION | SUMMARY | REQUIREMENTS | Final |
|--------|-------------|-------------|---------|-------------|-------|
| RDIR-01 | iOS auto-redirect to App Store via 307 | SATISFIED | listed | [x] | satisfied |
| RDIR-02 | Android auto-redirect to Google Play via 307 | SATISFIED | listed | [x] | satisfied |
| RDIR-03 | Crawlers bypass redirect | SATISFIED | listed | [x] | satisfied |
| RDIR-04 | iPadOS users see fallback page | SATISFIED | listed | [x] | satisfied |
| RDIR-05 | Detection runs in middleware | SATISFIED | listed | [x] | satisfied |

### Phase 5: Fallback Page & Component

| REQ-ID | Description | VERIFICATION | SUMMARY | REQUIREMENTS | Final |
|--------|-------------|-------------|---------|-------------|-------|
| PAGE-01 | Branded page with both store badges | SATISFIED | missing | [x] | satisfied* |
| PAGE-02 | Pure server component, no client JS | SATISFIED | missing | [x] | satisfied* |
| PAGE-03 | Smart App Banner meta tag | SATISFIED (with caveat) | missing | [x] | satisfied* |
| PAGE-04 | Uses existing assets and constants | SATISFIED | missing | [x] | satisfied* |

*Manually verified — SUMMARY frontmatter missing `requirements-completed` but VERIFICATION.md confirms all 4 requirements satisfied.

### Phase 6: SEO & Sitemap (NOT STARTED)

| REQ-ID | Description | VERIFICATION | SUMMARY | REQUIREMENTS | Final |
|--------|-------------|-------------|---------|-------------|-------|
| SEO-01 | Next.js metadata with OG tags | orphaned | orphaned | [ ] | **unsatisfied** |
| SEO-02 | Canonical URL and Twitter cards | orphaned | orphaned | [ ] | **unsatisfied** |
| SEO-03 | JSON-LD MobileApplication data | orphaned | orphaned | [ ] | **unsatisfied** |
| SEO-04 | /download in sitemap.ts | orphaned | orphaned | [ ] | **unsatisfied** |

## Cross-Phase Integration

All 7 cross-phase wiring connections verified:

| From | To | Via | Status |
|------|----|-----|--------|
| `constants/links.ts` | `middleware.ts` (Phase 4) | import APP_STORE_LINK, GOOGLE_PLAY_LINK | WIRED |
| `constants/links.ts` | `AppStoreBadges.tsx` (Phase 5) | import APP_STORE_LINK, GOOGLE_PLAY_LINK | WIRED |
| `constants/bots.ts` (Phase 4) | `middleware.ts` (Phase 4) | import BOT_PATTERNS | WIRED |
| `middleware.ts` matcher (Phase 4) | `download/page.tsx` (Phase 5) | NextResponse.next() fallthrough | WIRED |
| `AppStoreBadges/index.ts` (Phase 5) | `download/page.tsx` (Phase 5) | import AppStoreBadges | WIRED |
| `/public/app-store-badge.svg` | `AppStoreBadges.tsx` | Image src | WIRED |
| `/public/google-play-badge.png` | `AppStoreBadges.tsx` | Image src | WIRED |

## E2E Flow Verification

| Flow | Path | Status |
|------|------|--------|
| iOS user → App Store | Request → middleware (iPhone UA detected) → 307 redirect → App Store | COMPLETE |
| Android user → Google Play | Request → middleware (Android UA detected) → 307 redirect → Google Play | COMPLETE |
| Desktop user → Download page | Request → middleware passthrough → page.tsx renders badges | COMPLETE |
| Crawler → Download page | Request → middleware bot detection → passthrough → page.tsx HTML content | COMPLETE |

## Integration Findings

### LayoutContent Gate (Deployment Risk)

`src/components/LayoutContent/LayoutContent.tsx` wraps all pages. The `/download` path is not in `allowedPaths`. When `NEXT_PUBLIC_IS_LAUNCHED` is not `'true'`, users see `<ComingSoon />` instead of the download page.

- **Current .env:** `NEXT_PUBLIC_IS_LAUNCHED="true"` — development works
- **Production risk:** If env var is unset in production, /download is silently blocked
- **Fix:** Add `/download` to `allowedPaths` array OR ensure production env has the variable set
- **Affects:** PAGE-01, PAGE-02, PAGE-03, PAGE-04, RDIR-03, RDIR-04

### Phase 6 SEO Gap

Crawlers currently see basic HTML content (heading, description, store links) but lack:
- OG tags for social sharing previews
- Canonical URL and Twitter card meta tags
- JSON-LD structured data for rich results
- Sitemap entry for crawler discovery

This does not break existing functionality — it is additive Phase 6 work.

## Tech Debt Summary

| Phase | Items |
|-------|-------|
| Phase 4 | Human verification needed: iOS/Android redirects on real devices, Slackbot pass-through on deployed URL |
| Phase 5 | SUMMARY.md missing requirements-completed frontmatter; Smart App Banner needs real Safari verification |
| Deployment | LayoutContent gate: /download needs allowedPaths entry or NEXT_PUBLIC_IS_LAUNCHED in production |

**Total:** 5 items across 3 phases

---

*Audited: 2026-02-28*
*Auditor: Claude (gsd milestone auditor)*
